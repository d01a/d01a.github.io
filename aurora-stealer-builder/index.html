<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Aurora Stealer Builder - d01a</title><meta name="Description" content="Aurora Stealer Builder"><meta property="og:title" content="Aurora Stealer Builder" />
<meta property="og:description" content="Aurora Stealer Builder" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://d01a.github.io/aurora-stealer-builder/" /><meta property="og:image" content="https://d01a.github.io/aurora-stealer-builder/featured-image.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-23T09:04:49+08:00" />
<meta property="article:modified_time" content="2023-04-23T22:11:05+02:00" /><meta property="og:site_name" content="d01a" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://d01a.github.io/aurora-stealer-builder/featured-image.jpg"/>
<meta name="twitter:title" content="Aurora Stealer Builder"/>
<meta name="twitter:description" content="Aurora Stealer Builder"/>
<meta name="application-name" content="d01a">
<meta name="apple-mobile-web-app-title" content="d01a"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/ico.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://d01a.github.io/aurora-stealer-builder/" /><link rel="prev" href="https://d01a.github.io/aurora-stealer/" /><link rel="next" href="https://d01a.github.io/pikabot/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Aurora Stealer Builder",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/d01a.github.io\/aurora-stealer-builder\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/d01a.github.io\/aurora-stealer-builder\/featured-image.jpg",
                            "width":  1920 ,
                            "height":  730 
                        }],"genre": "posts","keywords": "Malware Analysis, Reverse Engineering","wordcount":  4904 ,
        "url": "https:\/\/d01a.github.io\/aurora-stealer-builder\/","datePublished": "2023-04-23T09:04:49+08:00","dateModified": "2023-04-23T22:11:05+02:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Mohamed Adel","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/d01a.github.io\/images\/avatar.png",
                    "width":  715 ,
                    "height":  715 
                }},"author": {
                "@type": "Person",
                "name": "Mohamed Adel"
            },"description": "Aurora Stealer Builder"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="d01a"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/ico.png"
        data-srcset="/images/ico.png, /images/ico.png 1.5x, /images/ico.png 2x"
        data-sizes="auto"
        alt="/images/ico.png"
        title="/images/ico.png" width="600" height="600" />d01a</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/d01a" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="d01a"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/ico.png"
        data-srcset="/images/ico.png, /images/ico.png 1.5x, /images/ico.png 2x"
        data-sizes="auto"
        alt="/images/ico.png"
        title="/images/ico.png" width="600" height="600" />d01a</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/d01a" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Aurora Stealer Builder</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://d01a.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Mohamed Adel</a></span>&nbsp;<span class="post-category">included in <a href="/categories/malware-analysis/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Malware Analysis</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-04-23">2023-04-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;4904 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;24 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/featured-image.jpg"
        data-srcset="/aurora-stealer-builder/featured-image.jpg, /aurora-stealer-builder/featured-image.jpg 1.5x, /aurora-stealer-builder/featured-image.jpg 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/featured-image.jpg"
        title="Aurora Stealer Builder" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#startup-info">Startup info</a>
      <ul>
        <li><a href="#authentication-method">Authentication method</a></li>
        <li><a href="#server-authentication-check">Server Authentication check</a></li>
        <li><a href="#dynamic-key-calculation">Dynamic Key calculation</a></li>
        <li><a href="#server-response-info">Server Response Info</a></li>
        <li><a href="#network-emulation">Network emulation</a></li>
        <li><a href="#anti-debugging-check">Anti-Debugging check</a></li>
        <li><a href="#license-info-and-ip-used">License info and IP used</a></li>
        <li><a href="#why-network-emulation-doesnt-work-well">Why network emulation doesn’t work well</a></li>
      </ul>
    </li>
    <li><a href="#main-functionality">Main Functionality</a>
      <ul>
        <li><a href="#ip-geolocation-database">IP Geolocation database</a></li>
        <li><a href="#bot-state">Bot state</a></li>
        <li><a href="#clear-old-screenshots">Clear old screenshots</a></li>
        <li><a href="#command-receiver">Command Receiver</a></li>
        <li><a href="#main-server-functionality">Main server functionality</a></li>
        <li><a href="#server-start">server start!</a></li>
        <li><a href="#tcp-listener">TCP listener</a></li>
      </ul>
    </li>
    <li><a href="#main-client">Main Client</a>
      <ul>
        <li><a href="#handling-incoming-data">Handling incoming data</a></li>
        <li><a href="#update-victims-db">Update victims DB</a></li>
        <li><a href="#the-victims-location-identification">The victim’s Location identification</a></li>
      </ul>
    </li>
    <li><a href="#main-web-server">Main web server</a></li>
    <li><a href="#older-version-of-the-builder">Older version of the builder</a></li>
    <li><a href="#web-service-html-templates">Web service HTML templates</a></li>
    <li><a href="#yara-rules">Yara Rules</a></li>
    <li><a href="#iocs">IOCs:</a></li>
    <li><a href="#yara-seeds">Yara Seeds</a></li>
    <li><a href="#acknowledgments">Acknowledgments:</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="introduction">Introduction</h2>
<p>in the previous article, I discussed what’s inside Aurora Stealer. After the release, <a href="https://twitter.com/gi7w0rm" target="_blank" rel="noopener noreffer ">@Gi7w0rm</a> provided me samples of some versions of Aurora Stealer builder, a new version that was created recently and another one that was created in 2022. The newer version has some improvements in the builder and new features we will discuss in this article. Before we start this article, it is important to note that the Builder also contains and creates the Web panel to control the bots. This means the binaries we are looking at are actually a hybrid between a builder and a panel.</p>
<h2 id="startup-info">Startup info</h2>
<p>In <code>main_main</code> the first display page is prepared to accept the credentials of the user and start checking them. It first displays an ASCII art of the word Aurora and provides communication channels for contacting the Aurora developers.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled.png"
        title="Untitled" width="603" height="239" /></p>
<p>After the initial screen, it saves the UUID of the user, with the same function discussed before to make sure that only one user is using the builder.</p>
<p>Then it asks for the login and password of the user</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%201.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%201.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%201.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%201.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%201.png"
        title="Untitled" width="568" height="632" /></p>
<h3 id="authentication-method">Authentication method</h3>
<p>After the credentials where provided, it calls <code>main_createAccess</code>. it saves the string <code>123</code> It passes the directory <code>./cache/Auth.aurora</code> to a function called <code>main_exists</code>  that checks if the file exists or not. If it existed it will ask for hand deleting it, if not it will create it.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%202.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%202.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%202.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%202.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%202.png"
        title="Untitled" width="930" height="635" /></p>
<p>It appends the UUID and the string <code>AURORA_TECHNOLOGY</code>  and calculates the MD5 hash to it using the  form</p>
<p><code>&lt;UUID&gt;AURORA_TECNOLOGY</code></p>
<p>after which it takes this hash to make a string in the following form:</p>
<p><code>123_aurora_&lt;MD5_OF(&lt;UUID&gt;AURORA_TECNOLOGY)&gt;_technology_123</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%203.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%203.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%203.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%203.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%203.png"
        title="Untitled" width="461" height="46" /></p>
<p>Then the SHA1 hash is calculated for this string:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%204.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%204.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%204.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%204.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%204.png"
        title="Untitled" width="426" height="121" /></p>
<p>It generates the first string again and its MD5 hash. It uses the MD5 hash as a key for the AES GCM encryption routine. The generated bytes are then written to <code>./cache/Auth.aurora</code></p>
<p>To know what was written to the file, we can use this script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">binascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># key is MD5 hash of &lt;UUID&gt;AURORA_TECHNOLOGY</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&lt;KEY&gt;&#34;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># Auth.aurora content</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="s2">&#34;&lt;CIPHER&gt;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">12</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cleartext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt_and_verify</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="o">-</span><span class="mi">16</span><span class="p">],</span> <span class="n">tag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">cleartext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cleartext is SHA1 hash of the string &#34;123_aurora_&lt;MD5_OF(&lt;UUID&gt;AURORA_TECNOLOGY)&gt;_technology_123 &#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>which shows us the SHA-1 Hash of the string: <code>123_aurora_&lt;MD5_OF(&lt;UUID&gt;AURORA_TECNOLOGY)&gt;_technology_123</code></p>
<h3 id="server-authentication-check">Server Authentication check</h3>
<p>Going back to <code>main_main</code> , where it creates yet another hash:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%205.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%205.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%205.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%205.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%205.png"
        title="Untitled" width="871" height="536" /></p>
<p>This time, the password and login is used to create a string using the following form <code>&lt;LOGIN&gt;_*Aurora_2023_Technology_&lt;PASS&gt;.</code> then it calculates the SHA1 hash of it.*</p>
<p>Then, it calls <code>main_server</code> . This could be where the authentication of the user happens, just a hypothesis.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%206.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%206.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%206.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%206.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%206.png"
        title="Untitled" width="540" height="191" /></p>
<p>it sleeps 1000000000 nanoseconds. Then it makes a TCP connection with <code>185.106.93.237:56763</code> which seems to be the server where user authentication is done.</p>
<h3 id="dynamic-key-calculation">Dynamic Key calculation</h3>
<p>If the connection is established, it calls <code>main_DynamicKey</code> which generates a key based on the current minutes in the current time, In <code>America/Los_Angeles</code> time format.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%207.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%207.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%207.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%207.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%207.png"
        title="Untitled" width="541" height="520" /></p>
<p>and calculate the SHA1 hash of it.</p>
<p>Back in the <code>main_Server</code> function the builder then puts all the hashes in JSON format to be sent to the server.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%208.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%208.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%208.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%208.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%208.png"
        title="Untitled" width="467" height="116" /></p>
<h3 id="server-response-info">Server Response Info</h3>
<p>the remote server then verifies the given data and response with one of the few response strings below:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%209.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%209.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%209.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%209.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%209.png"
        title="Untitled" width="1631" height="629" /></p>
<table>
<thead>
<tr>
<th>Response</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>HWID_BAD</td>
<td>[Aurora] HWID has a different value on the license server, write support</td>
</tr>
<tr>
<td>NOT_FOUND_ACCOUNT</td>
<td>[Aurora] Account has been not found, wrong login or password.</td>
</tr>
<tr>
<td>LOST_LICENSE</td>
<td>[Aurora] License expired.</td>
</tr>
<tr>
<td>DYNAMIC_KEY</td>
<td>[Aurora] Dynamic key wrong, check time your OS or write support.</td>
</tr>
</tbody>
</table>
<h3 id="network-emulation">Network emulation</h3>
<p>I tried to emulate the C2 communication with fakenet. After a very long time trying to do that. it works to respond to it with the format of data it waits for, but there is something still missing.</p>
<p>I edited the configs of the <code>TCPListener</code> of fakenet as can be seen below:</p>
<ol>
<li>In <code>default.ini</code> edit the default configs to the following:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="n">RawTCPListener</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Enabled</span><span class="p">:</span>     <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">Port</span><span class="p">:</span>        <span class="mi">56763</span> <span class="c1"># port it comm over</span>
</span></span><span class="line"><span class="cl"><span class="n">Protocol</span><span class="p">:</span>    <span class="n">TCP</span>
</span></span><span class="line"><span class="cl"><span class="n">Listener</span><span class="p">:</span>    <span class="n">RawListener</span>
</span></span><span class="line"><span class="cl"><span class="n">UseSSL</span><span class="p">:</span>      <span class="n">No</span>
</span></span><span class="line"><span class="cl"><span class="n">Timeout</span><span class="p">:</span>     <span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="n">Hidden</span><span class="p">:</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To read about customizing responses, see docs/CustomResponse.md</span>
</span></span><span class="line"><span class="cl"><span class="n">Custom</span><span class="p">:</span>    <span class="n">sample_custom_response</span><span class="o">.</span><span class="n">ini</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Create or use the <code>sample_custom_response.ini</code> provided to contain the following, this is already set by default:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="n">ExampleTCP</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">InstanceName</span><span class="p">:</span>     <span class="n">RawTCPListener</span>
</span></span><span class="line"><span class="cl"><span class="n">TcpDynamic</span><span class="p">:</span>       <span class="n">CustomProviderExample</span><span class="o">.</span><span class="n">py</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>The builder waits for a JSON string delimited by the character <code>0x0A</code> if this is not in the response it will wait forever.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2010.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2010.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2010.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2010.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2010.png"
        title="Untitled" width="399" height="124" /></p>
<p>As a result <code>CustomProviderExample.py</code>  should contain a JSON string ending with <code>0x0A</code> , I was testing with the following code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">HandleTcp</span><span class="p">(</span><span class="n">sock</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Handle a TCP buffer.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    Parameters
</span></span></span><span class="line"><span class="cl"><span class="s2">    ----------
</span></span></span><span class="line"><span class="cl"><span class="s2">    sock : socket
</span></span></span><span class="line"><span class="cl"><span class="s2">        The connected socket with which to recv and send data
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;{&#34;Test&#34;:&#34;test&#34;,&#34;Test2&#34;:&#34;Test2&#34;}</span><span class="se">\x0A</span><span class="s1">&#39;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>A value of the JSON string accepted must be the Dynamic key which is generated based on the local time of the user.</p>
<h3 id="anti-debugging-check">Anti-Debugging check</h3>
<p>This Dynamic key is calculated again and the two values are compared in order to check if the sample is being debugged. Nice!</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2011.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2011.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2011.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2011.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2011.png"
        title="Untitled" width="816" height="472" /></p>
<h3 id="license-info-and-ip-used">License info and IP used</h3>
<p>The JSON strings also contain some other information about the User and the license</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2012.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2012.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2012.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2012.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2012.png"
        title="Untitled" width="853" height="495" /></p>
<p>Also, it contains an IP that is used later in some other interesting functions. the author expects only one IP to be used by the builder.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2013.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2013.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2013.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2013.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2013.png"
        title="Untitled" width="722" height="190" /></p>
<p>It calls <code>convTstring</code> which takes a generic value -any type- and converts it to a string. I don’t really know why it calls <code>convTstring</code> as it is an IP it would be passed as a string in the JSON. maybe later we realize what’s going on here.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2014.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2014.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2014.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2014.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2014.png"
        title="Untitled" width="769" height="651" /></p>
<p>We see some calls to <code>runtime.newProc</code> . This function generates a new go running function and put it in a running Queue of other go functions waiting to run. This is generated by the compiler when using <code>go</code> keyword. Interested topic hah? Read more about it <a href="https://www.golang-book.com/books/intro/10" target="_blank" rel="noopener noreffer ">here</a>. Sadly it makes debugging more difficult.</p>
<h3 id="why-network-emulation-doesnt-work-well">Why network emulation doesn’t work well</h3>
<p>Back to the JSON data, it’s decoded with  <code>json.Unmashal</code> function which takes a structure as an input and with the second parameter being the data in bytes. How is the data mapped to the structure? Well, according to <a href="https://go.dev/blog/json" target="_blank" rel="noopener noreffer ">Go documentation</a></p>
<blockquote>
<p>How does <code>Unmarshal</code> identify the fields in which to store the decoded data? For a given JSON key <code>&quot;Foo&quot;</code>, <code>Unmarshal</code> will look through the destination struct’s fields to find (in order of preference):</p>
<ul>
<li>An exported field with a tag of <code>&quot;Foo&quot;</code> (see the <a href="https://go.dev/ref/spec#Struct_types" target="_blank" rel="noopener noreffer ">Go spec</a> for more on struct tags),</li>
<li>An exported field named <code>&quot;Foo&quot;</code>, or</li>
<li>An exported field named <code>&quot;FOO&quot;</code> or <code>&quot;FoO&quot;</code> or some other case-insensitive match of <code>&quot;Foo&quot;</code>.</li>
</ul>
<p>What happens when the structure of the JSON data doesn’t exactly match the Go type?</p>
<p><code>Unmarshal</code> will decode only the fields that it can find in the destination type</p>
</blockquote>
<p>So, we should guess the names of the JSON data. One of them is <code>Dynamic key</code> but we should figure out how it’s decoded.</p>
<p>We can use the pattern of the previously sent data, It was called <code>DK</code> .  Sadly, this and other attempts didn’t work. So, I will continue the other things only static in IDA.</p>
<h2 id="main-functionality">Main Functionality</h2>
<p>The main functionality of the builder is invoked with a series of goroutine calls. Each called function is preparing some data to be used later or to start the server itself. This serves as the main function of the builder.</p>
<h3 id="ip-geolocation-database">IP Geolocation database</h3>
<p>The first function of the series of <code>newProc</code> calls is <code>main_LoadToDB</code> which loads a very huge file called <code>geo.aurora</code>   that contains a list of IP ranges all over the world.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2015.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2015.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2015.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2015.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2015.png"
        title="Untitled" width="562" height="492" /></p>
<p>Viewing the cross-reference we can deduce that it is used to identify the geo-location of a victim.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2016.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2016.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2016.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2016.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2016.png"
        title="Untitled" width="560" height="91" /></p>
<p>A sample of the content of <code>geo.Aurora</code> can be seen below. The file contains ~380MB of data like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;AU&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Queensland&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.0.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.0.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;CN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Fujian&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.3.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;AU&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Victoria&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.4.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.7.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;CN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Guangdong&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.8.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.15.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Tokyo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.16.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.16.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Tokyo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.17.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.31.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;CN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Guangdong&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.32.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.63.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Hiroshima&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.64.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.64.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Hiroshima&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.65.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.66.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Hiroshima&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.67.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.67.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Hiroshima&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.68.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.68.127&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Miyagi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.68.128&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.69.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Country_short&#34;</span><span class="p">:</span> <span class="s2">&#34;JP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;City&#34;</span><span class="p">:</span> <span class="s2">&#34;Hiroshima&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Region&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Timezone&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;In&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.70.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Out&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.71.255&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="err">....</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="bot-state">Bot state</h3>
<p>The second function is to get the status of the infected systems. This includes a check if the bot is active, the last connection time of the bot, and the current time.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2017.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2017.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2017.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2017.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2017.png"
        title="Untitled" width="1438" height="503" /></p>
<h3 id="clear-old-screenshots">Clear old screenshots</h3>
<p>The third function deletes all the screenshots stored in the <code>bot</code> directory!</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2018.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2018.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2018.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2018.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2018.png"
        title="Untitled" width="526" height="150" /></p>
<p>It sorts the pictures to be deleted by <code>_</code> in it, then it gets what has <code>ACTUAL</code> word in it, lastly, it deletes the file extension <code>.png</code> from the string using <code>strings.Trim</code> and the new string should be a number as it calls <code>strconv.atoi</code> and then gets the current time. What a mess!</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2019.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2019.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2019.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2019.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2019.png"
        title="Untitled" width="779" height="615" /></p>
<p>It then proceeds to finally delete the file.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2020.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2020.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2020.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2020.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2020.png"
        title="Untitled" width="532" height="227" /></p>
<h3 id="command-receiver">Command Receiver</h3>
<p>The next function is <code>main_CommandReceiver</code>. It queues the commands received by the builder.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2021.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2021.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2021.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2021.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2021.png"
        title="Untitled" width="479" height="168" /></p>
<p>The function <code>map.Range</code> has the definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">Map</span><span class="p">)</span> <span class="nf">Range</span><span class="p">(</span><span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="nx">any</span><span class="p">)</span> <span class="kt">bool</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>where f is a function called for each &lt;key,value&gt; pair. So the variable <code>CMD_QUEUE</code> would contain the received commands.</p>
<p>Going through the function <code>main_CommandReceiver_func2</code> we see that the software first checks if the received command is <code>STOP</code>. If the STOP command is received, the builder exits.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2022.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2022.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2022.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2022.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2022.png"
        title="Untitled" width="520" height="502" /></p>
<p>For all other commands, it goes to another function <code>main_CommandReceiver_func2_1</code> . It’s expecting a 3-character long command <code>MIX</code> .</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2023.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2023.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2023.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2023.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2023.png"
        title="Untitled" width="544" height="320" /></p>
<p>It packs data about the victims with GZip  and base64 encode it then, stores it back using <code>map.store</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2024.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2024.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2024.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2024.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2024.png"
        title="Untitled" width="717" height="575" /></p>
<p>There were some log messages related to other commands here. However, I couldn’t figure out how the commands are treated. Based on the sample I discussed in a previous article, I guess this is connected to the messages sent from the victim machine.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2025.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2025.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2025.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2025.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2025.png"
        title="Untitled" width="1466" height="415" /></p>
<h3 id="main-server-functionality">Main server functionality</h3>
<p>The server is now ready to work and build the graphical interface of the builder to view the victim&rsquo;s data and state and further use the victims as Bots and Stealer hosting servers using SFTP.</p>
<h3 id="server-start">server start!</h3>
<p>Next function is <code>main_SERVER_func1</code> it calls <code>main_ForwardPort</code> with argument <code>:7367</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2026.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2026.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2026.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2026.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2026.png"
        title="Untitled" width="413" height="156" /></p>
<p>Then this function calls <code>aurora_core_server__Server_Start</code> , this long value is passed with the port number passed to its driver function</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2027.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2027.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2027.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2027.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2027.png"
        title="Untitled" width="464" height="177" /></p>
<p>This function starts the main server that displays the dashboard. I tried to adjust the execution to continue, but the program crashed.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2028.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2028.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2028.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2028.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2028.png"
        title="Untitled" width="1045" height="439" /></p>
<p>Note: <code>SixSixSix</code> is the author of the Stealer and not my username.</p>
<h3 id="tcp-listener">TCP listener</h3>
<p>Back to function <code>main_Server_0</code> (<code>main_Server</code>).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2029.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2029.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2029.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2029.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2029.png"
        title="Untitled" width="585" height="267" /></p>
<p>It logs the start of the server in the main display.</p>
<p>The server is started using <code>net.Listen</code> function that takes the protocol = <code>tcp</code> and port = <code>456</code> .</p>
<h2 id="main-client">Main Client</h2>
<p>After setting up the Server, the function <code>main_server_func2</code> is called.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2030.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2030.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2030.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2030.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2030.png"
        title="Untitled" width="725" height="491" /></p>
<p>This function only calls the <code>main_Client</code> function.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2031.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2031.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2031.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2031.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2031.png"
        title="Untitled" width="389" height="632" /></p>
<h3 id="handling-incoming-data">Handling incoming data</h3>
<p>To handle incoming data from the victim, the panel/builder reads the data on the listening port using <code>bufio__Reader_ReadString.</code> This data must be delimited by <code>0x0A</code> as discussed previously. It comes in a compressed format, so the function <code>main_uncompress</code>  is used to decompress it.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2032.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2032.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2032.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2032.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2032.png"
        title="Untitled" width="792" height="631" /></p>
<p>To do so, the function takes the  base64 encoded data and decodes it, then it is decompressed using GZip. You might remember from my last article, that this is the way the data was sent from the victim&rsquo;s device.</p>
<p>The data is in form of JSON so it’s extracted with a call to <code>json.Unmarshal</code> . The resulting data is then stored in a victim database file. The last message is additionally stored in the map function.</p>
<h3 id="update-victims-db">Update victims DB</h3>
<p>One of the first packets received from the victim is a large base64 blob. After decoding it using the above-mentioned method, it can be seen that this blob is a screenshot from the victim&rsquo;s machine.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2033.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2033.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2033.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2033.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2033.png"
        title="Untitled" width="531" height="630" /></p>
<p>This image is used to update the screenshot that contains <code>_ACTUAL.png</code> . The old one is then deleted.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2034.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2034.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2034.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2034.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2034.png"
        title="Untitled" width="525" height="605" /></p>
<p>The other screenshots are stored in a similar way but the name is different.</p>
<p>It updates the stolen victim data as well, and the last response from each infected host is stored in the previously created map.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2035.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2035.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2035.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2035.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2035.png"
        title="Untitled" width="558" height="583" /></p>
<h3 id="the-victims-location-identification">The victim’s Location identification</h3>
<p><code>main_GetGeo</code> is then called. If we remember, the loaded JSON string was referenced in this function.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2036.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2036.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2036.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2036.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2036.png"
        title="Untitled" width="434" height="547" /></p>
<p>It parses the string IP to convert to IP to a Go IP type which is a decimal dotted IP address.</p>
<p>Then it goes through a very large loaded JSON string that contains every IP range associated to each region all over the world.</p>
<p>The new victims will have an identifier is the string <code>MIX</code> that is checked to handle the new victims</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2037.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2037.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2037.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2037.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2037.png"
        title="Untitled" width="752" height="491" /></p>
<p>If the victim is new, it will store the screenshot with <code>_ACTUAL</code> tag as discussed before but there is no old one to delete.</p>
<p>At the very end of the function, a call to <code>main_Registration</code> is made.  This function just adds a new entry to the victims’ list and gets the geolocation of the victim.</p>
<h2 id="main-web-server">Main web server</h2>
<p>At the beginning of the function <code>main_Server</code> there was a goroutine that I missed initially. It calls <code>main_web</code> before the call to <code>net.Listen</code> .</p>
<p><code>main_web</code>  initializes the web interface of the builder and the dashboard with all of its functionality. the server starts at port <code>8181</code> .</p>
<p>The function follows the same pattern to set the methods of the handler for APIs:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2038.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2038.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2038.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2038.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2038.png"
        title="Untitled" width="419" height="105" /></p>
<p>The following table contains all available APIs with their associated handlers:</p>
<table>
<thead>
<tr>
<th>API</th>
<th>APIHandler name</th>
<th>APIHandler address</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>getbots</td>
<td>main_web_func1</td>
<td>0x7635A0</td>
<td>List all the victims by walking through main_BOT_CONN map</td>
</tr>
<tr>
<td>callback</td>
<td>main_web_func2</td>
<td>0x763800</td>
<td>get the callback message of each victim through the main_BOT_LASTMESSAGE or Queriyng the raw query of the connection address and get the message associated with victim IP</td>
</tr>
<tr>
<td>callback_STR</td>
<td>main_web_func3</td>
<td>0x763A00</td>
<td>get the callback message string for each victim stored at main_BOT_LASTMESSAGE_STRING</td>
</tr>
<tr>
<td>callback_ps</td>
<td>main_web_func4</td>
<td>0x763C00</td>
<td>get the PowerShell response of each victim through main_BOT_POWERSHELL_MESSAGE or Queriyng the raw query of the connection address and get the PowerShell message.</td>
</tr>
<tr>
<td>Statistic</td>
<td>main_web_func5</td>
<td>0x763E00</td>
<td>shows statistics about the victims stored in .Aurora file in ./bots/ folder and redirects to web/statistic.html html template. The statistics show all the users with their IP addresses and geolocation</td>
</tr>
<tr>
<td>send_pw</td>
<td>main_web_func6</td>
<td>0x764428</td>
<td>sends a base64 encoded PowerShell command to the victim using the json format. The associated key in the query is argument string</td>
</tr>
<tr>
<td>GiveMeBuild</td>
<td>main_web_func7</td>
<td>0x7648E0</td>
<td>checks\builds the executable file of the stealer <agent>.The build file is stored in .\build  it first checks if it exists on the system. if exists, tries to read it. If read is not successfully done, it exits. If not, the author prepared the file to be sent as an attachment for another remote system. it’s sent in the Content-deposition as follows: Content-Desposition: attachment = <build>.exe</td>
</tr>
<tr>
<td>send</td>
<td>main_web_func8</td>
<td>0x764E60</td>
<td>sends cmd \ PowerShell commands to the victims. They are sent through the argument key in the URL raw query</td>
</tr>
<tr>
<td>sftp_stop_reverse</td>
<td>main_web_func9</td>
<td>0x7655A0</td>
<td>closes the SFTP connection with the victims and closes the associated port forwarding functionality. Also, it deletes the entry associated with the deleted victim’s SFTP connection in main_BOT_CLIENT_SFTP map</td>
</tr>
<tr>
<td>sftp_reverse</td>
<td>main_web_func10</td>
<td>0x765820</td>
<td>start a SFTP server with the victim. the connection is done through port 7273 . The successful connection is indicated by WORK string. the configuration and data about the connection in the associated maps main_BOT_CLIENT_SFTP , main_BOT_LASTMESSAGE .  This reverse shell is then used to host the stealer. The infected Bots can be used in DoS attacks too.</td>
</tr>
<tr>
<td>screenshot</td>
<td>main_web_func11</td>
<td>0x766540</td>
<td>Takes a screenshot of the victim, it first checks if it’s active. SHA1 hash is calculated to the png file to see if the screenshot is the same as the stored or not before updating the database of the victims. the process is identified by Bad or Good statement.</td>
</tr>
<tr>
<td>bot</td>
<td>main_web_func12</td>
<td>0x766C00</td>
<td>displays the status of the bots and all information , online boots its geo location, SFTP connected bots in the web/bot.html html template page. it also reads the content of ./core/scr_n_f.png but I don’t see any use of it. It encodes the data in it and then redirect to bot.html</td>
</tr>
<tr>
<td>logout</td>
<td>main_web_func13</td>
<td>0x767680</td>
<td>Logs out!</td>
</tr>
<tr>
<td>auth</td>
<td>main_web_func14</td>
<td>0x767780</td>
<td>Authenticate the access of the client. It uses the file ./cache/Auth.Aurora to compare its content with the newly calculated hashes as discussed before.</td>
</tr>
<tr>
<td>dashboard</td>
<td>main_web_func15</td>
<td>0x767BA0</td>
<td>The dashboard of the stealer, which shows some data about the active and offline Bots.</td>
</tr>
<tr>
<td>del_cmd</td>
<td>main_web_func16</td>
<td>0x768220</td>
<td>deletes a registered command from the main_CMD_QUEUE assigned to the victim</td>
</tr>
<tr>
<td>commands</td>
<td>main_web_func17</td>
<td>0x768380</td>
<td>display the command selection interface in the web/commands.html html template</td>
</tr>
<tr>
<td>AddCommand</td>
<td>main_web_func18</td>
<td>0x768840</td>
<td>add a new command to the victim commands list, it reads the assigned commands JSON data and adds a new command to it buy calling main_AddCommand that updates main_CMD_QUEUE map assigned to the victim.</td>
</tr>
<tr>
<td>AddLoaderCommand</td>
<td>main_web_func19</td>
<td>0x768B60</td>
<td>add loader command. reads the response of the Client.Get() method and then the associated JSON data and base64 encode it. There are some strings used in the identification like EXTERNAL_RUN_PE_X64 . the data then stored in the associated map (main_CMD_QUEUE) and the victims DB</td>
</tr>
</tbody>
</table>
<ul>
<li><code>net.Query</code> in Go parses the raw query and returns the values.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">u</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">&#34;https://example.com/?a=1&amp;b=2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">q</span> <span class="o">:=</span> <span class="nx">u</span><span class="p">.</span><span class="nf">Query</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// q will have the values associated to a &amp; b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">))</span> <span class="c1">// print 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;b&#34;</span><span class="p">))</span> <span class="c1">// print 2
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="older-version-of-the-builder">Older version of the builder</h2>
<p>There’s another sample provided to me, executable hash33fc61e81efa609df51277aef261623bb291e2dd5359362d50070f7a441df0ad</p>
<p>This sample looks like it was one of the first trials of the author to create a stealer in Go. It depends on so many additional legitimate packages from GitHub to create the server and handle the database manipulation and some other things. In the newer builder, it seems like he got more familiar with the Go Language and didn’t rely on the packages from GitHub.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2039.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2039.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2039.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2039.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2039.png"
        title="Untitled" width="438" height="220" /></p>
<p>The package used to grab the favicon (from the first GitHub account), create the GUI web application (the second account), provide sqlite3 interface and provide a library like ReadLine in C.</p>
<p>The repositories are in the following table:</p>
<table>
<thead>
<tr>
<th>Old sample</th>
<th>New sample</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://github.com/adampresley/gofavigrab" target="_blank" rel="noopener noreffer ">http://github.com/adampresley/gofavigrab</a></td>
<td><a href="http://github.com/vmihailenco/tagparser" target="_blank" rel="noopener noreffer ">http://github.com/vmihailenco/tagparser</a></td>
</tr>
<tr>
<td><a href="http://github.com/asticode/go-astikit" target="_blank" rel="noopener noreffer ">http://github.com/asticode/go-astikit</a></td>
<td><a href="http://github.com/vmihailenco/msgpack" target="_blank" rel="noopener noreffer ">http://github.com/vmihailenco/msgpack</a></td>
</tr>
<tr>
<td><a href="http://github.com/chzyer/readline" target="_blank" rel="noopener noreffer ">http://github.com/chzyer/readline</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/go-telegram-bot-api/telegram-bot-api" target="_blank" rel="noopener noreffer ">http://github.com/go-telegram-bot-api/telegram-bot-api</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/gorilla/mux" target="_blank" rel="noopener noreffer ">http://github.com/gorilla/mux</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/jroimartin/gocui" target="_blank" rel="noopener noreffer ">http://github.com/jroimartin/gocui</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/manifoldco/promptui" target="_blank" rel="noopener noreffer ">http://github.com/manifoldco/promptui</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/mattn/go-runewidth" target="_blank" rel="noopener noreffer ">http://github.com/mattn/go-runewidth</a></td>
<td></td>
</tr>
<tr>
<td><a href="http://github.com/nsf/termbox-go" target="_blank" rel="noopener noreffer ">http://github.com/nsf/termbox-go</a></td>
<td></td>
</tr>
</tbody>
</table>
<p>The old sample has some functions that were described before, which were extended in the 2023 version. The hash calculation method and dynamic key but instead of <code>Aurora_Stealer_2023</code> it is <code>Aurora_Stealer_2022</code>. Then it connects to the remote server to authenticate the user data, to the IP <code>185.106.93.237:6969</code> using TCP protocol.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2040.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2040.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2040.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2040.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2040.png"
        title="Untitled" width="549" height="641" /></p>
<p>Another dynamic key is used to authenticate with the server, based on the current time too however in the old sample the string <code>Aurora_Stealer_SERVER</code> is used.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2041.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2041.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2041.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2041.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2041.png"
        title="Untitled" width="555" height="541" /></p>
<p>This key is sent to the remote server and calculated later in the following code to verify the user access and the dynamic key to make sure there is no debugging session started.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2042.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2042.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2042.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2042.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2042.png"
        title="Untitled" width="1080" height="666" /></p>
<p>If the keys do not match, the function breaks and the program is terminated.</p>
<p>Another dynamic key is calculated but this time for the client, it uses the string <code>Aurora_Stealer_2033</code> with the same timing method of calculation discussed.</p>
<p>The hashes are stored then in <code>ATX.Aurora</code> in <code>./cache</code> folder.</p>
<p>It then checks the existence of some files: <code>./cache/ATX.Aurora</code> , <code>./cache/telegram.Aurora</code> , <code>./cache/Config.Aurora</code> and <code>./cache/Trash</code> .</p>
<p><code>./cache/Trash</code> contains older Aurora executables, the older executables are auto-moved to this folder using PowerShell command, and the new version, which is expected to be in <code>.zip</code> format with the name <code>Update.zip</code>, is then unzipped and replaces the older version. The program is then restarted using PowerShell. This is all done in <code>main_AutoUpdate</code> function.</p>
<p>The function <code>main_ReadTGData</code> reads telegram data from the file <code>./cache/telegram.Aurora</code> which is AES encrypted. The authentication is done using a telegram bot through the telegram API.  This authentication method is removed from the new version, where everything is done through communicating with the remote server.</p>
<p>The old builder additionally contains an important function called <code>main_LoadStealer</code> . This function calls two other goroutines. both two functions execute PowerShell commands that configure the firewall to allow it to receive incoming TCP connections through Port 80 and 8081.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2043.png"
        data-srcset="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2043.png, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2043.png 1.5x, /aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2043.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer-builder/Aurora%20Stealer%20Builder%2071154b54173740119405bcc7b0c65504/Untitled%2043.png"
        title="Untitled" width="708" height="152" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#function main_LoadStealer_func2 allow it on local port 80</span>
</span></span><span class="line"><span class="cl"><span class="n">netsh</span> <span class="n">advfirewall</span> <span class="n">firewall</span> <span class="n">add</span> <span class="n">rule</span> <span class="n">name</span><span class="p">=</span><span class="err">”</span><span class="n">Port</span> <span class="n">80</span> <span class="n">dir</span><span class="p">=</span><span class="k">in</span> <span class="n">action</span><span class="p">=</span><span class="n">allow</span> <span class="n">protocol</span><span class="p">=</span><span class="n">TCP</span> <span class="n">localport</span><span class="p">=</span><span class="n">80</span>
</span></span><span class="line"><span class="cl"><span class="c">#function main_LoadStealer_func2 allow it on local port 80</span>
</span></span><span class="line"><span class="cl"><span class="n">netsh</span> <span class="n">advfirewall</span> <span class="n">firewall</span> <span class="n">add</span> <span class="n">rule</span> <span class="n">name</span><span class="p">=</span><span class="err">”</span><span class="n">Port</span> <span class="n">8081</span> <span class="n">dir</span><span class="p">=</span><span class="k">in</span> <span class="n">action</span><span class="p">=</span><span class="n">allow</span> <span class="n">protocol</span><span class="p">=</span><span class="n">TCP</span> <span class="n">localport</span><span class="p">=</span><span class="n">8081</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>At the end of the main function, it creates a new hidden instance of CMD and starts the Web service of the stealer.  using the function <code>main_StartWeb</code></p>
<p>This function starts the web service on localhost <code>http://127.0.0.1/dashboard</code> . It has a different set of APIs and different associated handlers then the newer version.</p>
<ul>
<li>The command strings are highlighted.</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>APIHandler name</th>
<th>APIHandler address</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>receive</td>
<td>main_StartWeb_func1</td>
<td>0x140421B00</td>
<td>It receives the incoming commands and connects to the remote server 185.106.93.237:6969 to get match the stored hashes with the calculated one in form of <LOGIN><em>Aurora</em>&lt;PASSWORD .this function has a lot of other functionality. it reads the command from the response of the server. It allows the user to delete a directory Delete, remove file grabber RemoveG, or remove the loader RemoveL.GEO_URL to get the geolocation of all victims. AddDmen Add a new domain name received from the server.BuildGen builds a new version of the stealer and the ability to increase the file size PumbMB.DeleteTG , AddTelegram delete\add telegram configuration.DeleteAll Delete all the configs.ChangePassword , change password and download all logs files Download_AllLogs. Download_OnlyCrypto downloads the crypto wallet information only.</td>
</tr>
<tr>
<td>api.exe</td>
<td>main_StartWeb_func2</td>
<td>0x140421B60</td>
<td>adds a new telegram API key to the stealer and adds an icon using resource hacker cmd command ./resource/ResourceHacker.exe -open ./builds/&lt;STEALER_NAME&gt;.exe -save ./builds/&lt;STEALER_NAME&gt;.exe -action addskip -res ./resource/main.ico -mask ICONGROUP,MAIN .</td>
</tr>
<tr>
<td>dashboard/{id:[0-9]+}</td>
<td>main_productsHandler</td>
<td>0x14041D080</td>
<td>display the main window of the web service displays information about a specific victim ID: Cookies, passwords, the Geolocation, and crypto wallet information. Logs are stored in ./logs/ folder contain passwords in passwords.txt , cookies in folder Cookies  . All the information is shown through the HTML template ./gui/Dashboard.html</td>
</tr>
<tr>
<td>download_geo</td>
<td>main_StartWeb_func3</td>
<td>0x140422100</td>
<td>retrieves the geolocation information, the same as the new one.</td>
</tr>
<tr>
<td>download_l</td>
<td>main_StartWeb_func4</td>
<td>0x1404222A0</td>
<td>gets the logs in a .zip archive, uncompresses it and deletes the archive. the logs contain all the stolen data</td>
</tr>
<tr>
<td>api/get-log-build</td>
<td>main_StartWeb_func5</td>
<td>0x140422620</td>
<td>get the build logs from ./logs associated with a specific API key used</td>
</tr>
<tr>
<td>build.exe</td>
<td>main_StartWeb_func6</td>
<td>0x140422B60</td>
<td>gets a build executable of the stealer stored at ./builds</td>
</tr>
<tr>
<td>dashboard</td>
<td>main_StartWeb_func7</td>
<td>0x140422EA0</td>
<td>display the dashboard of the stealer, and shows some statistics about the infected system. IPs, geo-location and the stolen information</td>
</tr>
<tr>
<td>loader</td>
<td>main_StartWeb_func8</td>
<td>0x140422FE0</td>
<td>display information about the Loader and file grabber. the threat actor can use this section to configure the loader and specify the target file to grab. file ./config/telegram.txt is used to extract the telegram connection configuration. The information is viewed by executing gui/Loader.html HTML template.</td>
</tr>
<tr>
<td>setting</td>
<td>main_StartWeb_func9</td>
<td>0x1404234A0</td>
<td>builder settings, display information about the subscribed plan and change the password and telegram configuration and API. and shows the used domains</td>
</tr>
<tr>
<td>auth</td>
<td>main_StartWeb_func10</td>
<td>0000000140423A40</td>
<td>the AUTH page that the user signs in to where the used credentials and AUTH cache file in ./cache/AuthHash.Aurora are checked. Whenever the user navigates, the credentials and hashes are checked. if not valid, will be redirected to this page</td>
</tr>
<tr>
<td>builder</td>
<td>main_StartWeb_func11</td>
<td>0x140423CC0</td>
<td>creates a new build through it. the build target architecture victims group is chosen.</td>
</tr>
<tr>
<td>checker</td>
<td>main_StartWeb_func12</td>
<td>0x140424380</td>
<td>checks the wanted information from the victim DB. check the build used and get the geolocation of the victim specified.</td>
</tr>
</tbody>
</table>
<p>then the server is started on port 80</p>
<p>In function <code>main_AddNewClient</code> , the victim entries on the data based are created by calling <code>main_CreateDB</code> data stored about the user in <code>UserInformation.txt</code>:</p>
<ul>
<li>HWID</li>
<li>Build ID</li>
<li>Log date</li>
<li>IP</li>
<li>Country</li>
<li>Region</li>
<li>City</li>
<li>PC INFORMATION
<ul>
<li>CPU</li>
<li>Screen Size</li>
<li>Screen Size</li>
<li>RAM</li>
<li>Display Device (GPU)</li>
</ul>
</li>
</ul>
<p>in addition to the stolen information the following credentials are received:</p>
<ul>
<li>Steam</li>
<li>Passwords</li>
<li>cookies</li>
<li>crypto wallets -stored in subdirectory <code>/wallets</code></li>
<li>Telegram info</li>
<li>screenshots</li>
<li>grabbed files -stored in subdirectory <code>./FileGrabber</code></li>
<li>Cards information</li>
</ul>
<p>Browser cookies are stored in <code>.db</code> files in <code>./cache</code> to be decrypted and the extracted data is stored in <code>.txt</code> file.</p>
<p>The end of the packet is checked by <code>END_PACKET_ALL_SEND</code> sentence. And the last packet sent to the victim is <code>Thanks</code> , then, the data are zipped and sent to the telegram account configured.</p>
<p>The function <code>main_DecryptLog_Card</code> is used to decrypt the credit card information collected. It uses the following sqlite3 query to achieve that:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">name_on_card</span><span class="p">,</span><span class="w"> </span><span class="n">expiration_month</span><span class="p">,</span><span class="w"> </span><span class="n">expiration_year</span><span class="p">,</span><span class="w"> </span><span class="n">card_number_encrypted</span><span class="p">,</span><span class="w"> </span><span class="n">date_modified</span><span class="p">,</span><span class="w"> </span><span class="n">use_date</span><span class="p">,</span><span class="w"> </span><span class="n">use_count</span><span class="p">,</span><span class="w"> </span><span class="n">nickname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">credit_cards</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web-service-html-templates">Web service HTML templates</h2>
<p>You can find screenshots of the HTML templates in this <a href="https://twitter.com/Gi7w0rm/status/1649899595307048966" target="_blank" rel="noopener noreffer ">tweet</a>.</p>
<h2 id="yara-rules">Yara Rules</h2>
<p>all the rules can be found <a href="https://github.com/d01a/yara-rules" target="_blank" rel="noopener noreffer ">here</a>.</p>
<p>new builder version</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rule</span> <span class="n">aurora_stealer_builder_new</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">malware</span> <span class="o">=</span> <span class="s2">&#34;Aurora stealer Builder new version 2023&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">hash</span> <span class="o">=</span> <span class="s2">&#34;ebd1368979b5adb9586ce512b63876985a497e1727ffbd54732cd42eef992b81&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">reference</span> <span class="o">=</span> <span class="s2">&#34;https://d01a.github.io/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Author</span> <span class="o">=</span> <span class="s2">&#34;d01a&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;detect Aurora stealer Builder new version 2023&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">strings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">is_go</span> <span class="o">=</span> <span class="s2">&#34;Go build&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s1</span> <span class="o">=</span> <span class="s2">&#34;_Aurora_2023_Technology_&#34;</span>    <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s2</span> <span class="o">=</span> <span class="s2">&#34;AURORA_TECHNOLOGY&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s3</span> <span class="o">=</span> <span class="s2">&#34;scr_n_f.png&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s4</span> <span class="o">=</span> <span class="s2">&#34;EXTERNAL_RUN_PE_X64&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s5</span> <span class="o">=</span> <span class="s2">&#34;[Aurora]&#34;</span> <span class="n">ascii</span> <span class="o">//</span><span class="n">log</span> <span class="n">messages</span> <span class="n">begin</span> <span class="k">with</span> <span class="p">[</span><span class="n">Aurora</span><span class="p">]</span> <span class="n">__LOGMSG__</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun1</span> <span class="o">=</span> <span class="s2">&#34;main.Server&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun2</span> <span class="o">=</span> <span class="s2">&#34;main.GetAcess&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun3</span> <span class="o">=</span> <span class="s2">&#34;main.AddCommand&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun4</span> <span class="o">=</span> <span class="s2">&#34;main.GetGeoList&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun5</span> <span class="o">=</span> <span class="s2">&#34;main.GiveMeBuild&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">condition</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5a4d</span> <span class="ow">and</span> <span class="p">(</span> <span class="err">$</span><span class="n">is_go</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">s</span><span class="o">*</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">fun</span><span class="o">*</span><span class="p">))</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>old builder version</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rule</span> <span class="n">aurora_stealer_builder_old</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">malware</span> <span class="o">=</span> <span class="s2">&#34;Aurora stealer Builder old version 2022&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">hash1</span> <span class="o">=</span> <span class="s2">&#34;33fc61e81efa609df51277aef261623bb291e2dd5359362d50070f7a441df0ad&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">reference</span> <span class="o">=</span> <span class="s2">&#34;https://d01a.github.io/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Author</span> <span class="o">=</span> <span class="s2">&#34;d01a&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;detect Aurora stealer Builder old version 2022&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">strings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">is_go</span> <span class="o">=</span> <span class="s2">&#34;Go build&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s1</span> <span class="o">=</span> <span class="s2">&#34;ATX.Aurora&#34;</span>    <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s2</span> <span class="o">=</span> <span class="s2">&#34;Aurora_Stealer_2033&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s3</span> <span class="o">=</span> <span class="s2">&#34;Aurora_Stealer_SERVER&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">s4</span> <span class="o">=</span> <span class="s2">&#34;[Aurora Stealer]&#34;</span> <span class="o">//</span><span class="n">log</span> <span class="n">messages</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun1</span> <span class="o">=</span> <span class="s2">&#34;main.DecryptLog&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun2</span> <span class="o">=</span> <span class="s2">&#34;main.CreateDB&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun3</span> <span class="o">=</span> <span class="s2">&#34;main.GenerateKey&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun4</span> <span class="o">=</span> <span class="s2">&#34;main.TGParce&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">condition</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5a4d</span> <span class="ow">and</span> <span class="p">(</span> <span class="err">$</span><span class="n">is_go</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">s</span><span class="o">*</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">fun</span><span class="o">*</span><span class="p">))</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="iocs">IOCs:</h2>
<table>
<thead>
<tr>
<th>ebd1368979b5adb9586ce512b63876985a497e1727ffbd54732cd42eef992b81</th>
<th>aurora.exe (2023 version)</th>
</tr>
</thead>
<tbody>
<tr>
<td>e7aa0529d4412a8cee5c20c4b7c817337fabb1598b44efbf639f4a7dac4292ad</td>
<td>builder archive  (2023 version)</td>
</tr>
<tr>
<td>33fc61e81efa609df51277aef261623bb291e2dd5359362d50070f7a441df0ad</td>
<td>aurora.exe (2022 version)</td>
</tr>
<tr>
<td>33b61eb5f84cb65f1744bd08d09ac2535fe5f9b087eef37826612b5016e21990</td>
<td>geo.Aurora</td>
</tr>
<tr>
<td>1def6bdec3073990955e917f1da2339f1c18095d31cc12452b40da0bd8afd431</td>
<td>ds.html</td>
</tr>
<tr>
<td>f1ba92ae32fcaeea8148298f4869aef9bcd4e85781586b69c83a830b213d3d3c</td>
<td>statistic.html</td>
</tr>
<tr>
<td>8b1abbb51594b6f1d4e4681204ed97371bd3d60f093e38b80b8035058116ef1d</td>
<td>bot.html</td>
</tr>
<tr>
<td>e9cf3e7d2826fa488e7803d0d19240a23f93a7f007d66377beb1849c5d51c0af</td>
<td>commands.html</td>
</tr>
<tr>
<td>d7829f17583b91fb1e8326e1c80c07fc29e0608f1ba836738d2c86df336ea771</td>
<td>rergister.html</td>
</tr>
<tr>
<td>1b88624936d149ecdea6af9147ff8b2d8423125db511bdf1296401033c08b532</td>
<td>settings.html</td>
</tr>
<tr>
<td>185.106.93.237:56763</td>
<td>Aurora server -version 2023- used in user account verification</td>
</tr>
<tr>
<td>185.106.93.237:6969</td>
<td>Aurora server -version 2022- used in user account verification</td>
</tr>
<tr>
<td>Auth.aurora</td>
<td>locally created for each Aurora panel user and used in account verification</td>
</tr>
<tr>
<td>scr_n_f.png</td>
<td>contains config information</td>
</tr>
<tr>
<td>screenshot/</td>
<td>a local folder that contains victims’ screenshots</td>
</tr>
<tr>
<td>&lt;*&gt;_ACTUAL.png</td>
<td>screenshot of current state of online bots</td>
</tr>
<tr>
<td>&lt;<em>&gt;_&lt;</em>&gt;.png</td>
<td>custom screenshots format</td>
</tr>
</tbody>
</table>
<p>The following go files were identified in the binary, all starting with the path: “C:/Users/SixSixSix/Desktop/Botnet 2023/26.01.2023/new/”</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">auth.go
</span></span><span class="line"><span class="cl">crypt.go
</span></span><span class="line"><span class="cl">command.go
</span></span><span class="line"><span class="cl">compressor.go
</span></span><span class="line"><span class="cl">core.go
</span></span><span class="line"><span class="cl">geo.go
</span></span><span class="line"><span class="cl">main.go
</span></span><span class="line"><span class="cl">pfor.go
</span></span><span class="line"><span class="cl">port.go
</span></span><span class="line"><span class="cl">web.go
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">core/statistics/window.go
</span></span><span class="line"><span class="cl">core/statistics/winfuns.go
</span></span><span class="line"><span class="cl">core/statistics/queue.go
</span></span><span class="line"><span class="cl">core/monitor/monitor.go
</span></span><span class="line"><span class="cl">core/common/copy.go
</span></span><span class="line"><span class="cl">core/common/udpconn.go
</span></span><span class="line"><span class="cl">core/common/util.go
</span></span><span class="line"><span class="cl">core/logger/logger.go
</span></span><span class="line"><span class="cl">core/schema/monitor.go
</span></span><span class="line"><span class="cl">core/schema/util.go
</span></span><span class="line"><span class="cl">core/server/client.go
</span></span><span class="line"><span class="cl">core/server/client_handlers.go
</span></span><span class="line"><span class="cl">core/server/server.go
</span></span><span class="line"><span class="cl">core/server/server_handlers.go
</span></span></code></pre></td></tr></table>
</div>
</div><p>There are similar files identified in the old version of the builder/panel.</p>
<p>The common path for this older sample is:
“C:/Users/SixSixSix/Desktop/Aurora 2022/server”</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">auth.go
</span></span><span class="line"><span class="cl">compressor.go
</span></span><span class="line"><span class="cl">config.go
</span></span><span class="line"><span class="cl">cryptography.go
</span></span><span class="line"><span class="cl">favicon.go
</span></span><span class="line"><span class="cl">geo.go
</span></span><span class="line"><span class="cl">gui.go
</span></span><span class="line"><span class="cl">main.go
</span></span><span class="line"><span class="cl">notify.go
</span></span><span class="line"><span class="cl">other.go
</span></span><span class="line"><span class="cl">server.go
</span></span><span class="line"><span class="cl">telegram.go
</span></span><span class="line"><span class="cl">zip.go
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="yara-seeds">Yara Seeds</h2>
<p>To create the Yara rules, the following strings were used. Those are all present in the builder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">127.0.0.1:7273
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">POWR
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">WORK
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT_FORWARD
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FTP_RUN - REVESRE START
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_*Aurora_2023_Technology_*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">AURORA_TECHNOLOGY
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./cache/Auth.aurora
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_ACTUAL
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./bots/screenshot/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./core/scr_n_f.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EXTERNAL_RUN_PE_X64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[Aurora] Botnet - SERVER - RUN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- old sample.
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ./cache/Config.Aurora
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ./cache/Aurora.Aurora
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ./cache/telegram.Aurora
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ./cache/ATX.Aurora
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Aurora_Stealer_2033
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Aurora_Stealer_SERVER
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Aurora_Stealer_2022
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    https://api.telegram.org/bot%s/%s
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ./cache/AuthHash.Aurora
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    [Aurora Stealer]: Yes i am work!
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="acknowledgments">Acknowledgments:</h2>
<p><a href="https://twitter.com/gi7w0rm" target="_blank" rel="noopener noreffer ">@gi7w0rm</a> for providing me with the samples and helping me formatting the article to make it better.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-04-23&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/80e2ac15859c0d0fb416bf36eca5a2c605158fbd" target="_blank" title="commit by mohamedadel46(muhammed195826@feng.bu.edu.eg) 80e2ac15859c0d0fb416bf36eca5a2c605158fbd: Aurora stealer builder">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>80e2ac1</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/aurora-stealer-builder/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://d01a.github.io/aurora-stealer-builder/" data-title="Aurora Stealer Builder" data-via="0xd01a" data-hashtags="Malware Analysis,Reverse Engineering"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://d01a.github.io/aurora-stealer-builder/" data-hashtag="Malware Analysis"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://d01a.github.io/aurora-stealer-builder/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://d01a.github.io/aurora-stealer-builder/" data-title="Aurora Stealer Builder"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://d01a.github.io/aurora-stealer-builder/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://d01a.github.io/aurora-stealer-builder/" data-title="Aurora Stealer Builder"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://d01a.github.io/aurora-stealer-builder/" data-title="Aurora Stealer Builder"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Trello" data-sharer="trello" data-url="https://d01a.github.io/aurora-stealer-builder/" data-title="Aurora Stealer Builder" data-description="Aurora Stealer Builder"><i class="fab fa-trello fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/malware-analysis/">Malware Analysis</a>,&nbsp;<a href="/tags/reverse-engineering/">Reverse Engineering</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/aurora-stealer/" class="prev" rel="prev" title="Aurora Stealer"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Aurora Stealer</a>
            <a href="/pikabot/" class="next" rel="next" title="Pikabot deep analysis">Pikabot deep analysis<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.102.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Mohamed Adel</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
