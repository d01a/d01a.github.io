<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Aurora Stealer - d01a</title><meta name="Description" content="Aurora Stealer"><meta property="og:title" content="Aurora Stealer" />
<meta property="og:description" content="Aurora Stealer" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://d01a.github.io/aurora-stealer/" /><meta property="og:image" content="https://d01a.github.io/aurora-stealer/featured-image.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-12T11:04:49+08:00" />
<meta property="article:modified_time" content="2023-04-14T00:57:15+02:00" /><meta property="og:site_name" content="d01a" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://d01a.github.io/aurora-stealer/featured-image.jpg"/>
<meta name="twitter:title" content="Aurora Stealer"/>
<meta name="twitter:description" content="Aurora Stealer"/>
<meta name="application-name" content="d01a">
<meta name="apple-mobile-web-app-title" content="d01a"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/Luffy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://d01a.github.io/aurora-stealer/" /><link rel="prev" href="https://d01a.github.io/originlogger/" /><link rel="next" href="https://d01a.github.io/aurora-stealer-builder/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Aurora Stealer",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/d01a.github.io\/aurora-stealer\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/d01a.github.io\/aurora-stealer\/featured-image.jpg",
                            "width":  1024 ,
                            "height":  575 
                        }],"genre": "posts","keywords": "Malware Analysis, Reverse Engineering","wordcount":  2414 ,
        "url": "https:\/\/d01a.github.io\/aurora-stealer\/","datePublished": "2023-04-12T11:04:49+08:00","dateModified": "2023-04-14T00:57:15+02:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Mohamed Adel","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/d01a.github.io\/images\/avatar.png",
                    "width":  715 ,
                    "height":  715 
                }},"author": {
                "@type": "Person",
                "name": "Mohamed Adel"
            },"description": "Aurora Stealer"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="d01a"><span class="header-title-pre"><i class='fa-solid fa-skull' aria-hidden='true'></i></span>d01a</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/d01a" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="d01a"><span class="header-title-pre"><i class='fa-solid fa-skull' aria-hidden='true'></i></span>d01a</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/d01a" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Aurora Stealer</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://d01a.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Mohamed Adel</a></span>&nbsp;<span class="post-category">included in <a href="/categories/malware-analysis/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Malware Analysis</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-04-12">2023-04-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2414 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;12 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/featured-image.jpg"
        data-srcset="/aurora-stealer/featured-image.jpg, /aurora-stealer/featured-image.jpg 1.5x, /aurora-stealer/featured-image.jpg 2x"
        data-sizes="auto"
        alt="/aurora-stealer/featured-image.jpg"
        title="Aurora Stealer" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#basic-information">Basic information</a>
      <ul>
        <li><a href="#binary-identification">Binary Identification</a></li>
        <li><a href="#code-analysis">Code Analysis</a></li>
        <li><a href="#calling-conventions-in-go">Calling Conventions in GO</a></li>
        <li><a href="#strings-in-go">Strings in GO</a></li>
        <li><a href="#connect-to-server">Connect To server</a></li>
        <li><a href="#collect-victim-information">Collect victim information</a></li>
        <li><a href="#file-grabber">File grabber</a></li>
        <li><a href="#browser-data">Browser data</a></li>
        <li><a href="#crypto">Crypto</a></li>
        <li><a href="#screenshot-capture">Screenshot Capture</a></li>
        <li><a href="#telegram-data">Telegram Data</a></li>
        <li><a href="#steam-data">Steam data</a></li>
        <li><a href="#send-to-server">send To server</a></li>
      </ul>
    </li>
    <li><a href="#network-analysis">Network Analysis</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#iocs">IOCs:</a></li>
    <li><a href="#yara-rule">Yara Rule</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="introduction">Introduction</h2>
<p>Aurora Stealer is an information stealer Written in GO. It is a commercial stealer that costs around 250$ per month. The malware can steal Browser password and saved cookies, crypto information (Desktop and Web), Telegram, Steam and Specific files from the victim machine and can take a screenshot from it.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled.png"
        title="Untitled" width="680" height="591" /></p>
<h2 id="basic-information">Basic information</h2>
<p>The icon of the executable gives us a hit about how this is spreading. It has Photoshop icon, most probably it was spreading using Malvertising.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%201.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%201.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%201.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%201.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%201.png"
        title="Untitled" width="542" height="455" /></p>
<h3 id="binary-identification">Binary Identification</h3>
<p>First we want to know some basic information about the file so I will use <a href="https://github.com/horsicq/Detect-It-Easy" target="_blank" rel="noopener noreffer ">DiE</a> to do so.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%202.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%202.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%202.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%202.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%202.png"
        title="Untitled" width="717" height="430" /></p>
<p>It was identified as GO binary. <code>.symtab</code> is a legacy section in GO binaries. In GO binaries prior to Version 1.3 <code>.symtab</code> section hold the symbol table but it is no longer filed with anything useful.
Without Symbols, the reversing will be so hard as a simple Hello world program in GO has about 2000 function this is a result of that GO compiler statically linking all the needed libraries. Later, I will try to tackle this problem using existed Tools.</p>
<p>An important aspect of the basic Triaging of a Malware is to check the readable Strings of the file. But GO is different in everything. The strings has a part of that too.</p>
<p>In GO, the strings are stored in Unicode format without null terminating character so many tools will handle that wrong. Also, the existence of this large number of library functions will make it worse. The resulting number of lines using strings utility in Die is 7371 line. We can reduce this number by matching for the library functions like the following Regex</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">.*</span><span class="p">(</span><span class="n">runtime</span><span class="o">|</span>\<span class="o">/</span><span class="n">usr</span><span class="o">|</span>\<span class="o">/</span><span class="n">root</span><span class="p">)</span><span class="o">.*</span>\<span class="n">n</span><span class="err">?</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>this matches the lines that contains runtime, usr and root. this filters around 2500 line but still around 5000 line. these lines contains the function imported in program, you can check them but it will be so exhausting to get information from it. Let’s Continue our analysis using the disassembler.</p>
<h3 id="code-analysis">Code Analysis</h3>
<p>I will upload the sample to IDA to explore it. In the old versions of IDA, Library functions will not be recognized and renamed. Also the types will be mostly wrong.</p>
<p>To handle this there is some tools you can use to fix the types and names. I’ve used <a href="https://github.com/mandiant/GoReSym" target="_blank" rel="noopener noreffer ">GoReSym</a>.</p>
<p>This is a standalone executable you can run with following parameters</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">GoReSym_win</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">t</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">PATH_TO_FILE</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">fix</span><span class="o">.</span><span class="n">json</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>for more info about the available parameters, Check the repo of the tool.</p>
<p>content of the output is in JSON format so I saved it to use it in this <a href="https://github.com/mandiant/GoReSym/blob/master/IDAPython/goresym_rename.py" target="_blank" rel="noopener noreffer ">IDA Script</a> to rename the functions and correct the types in IDA database.</p>
<p>NOTE: <code>-t</code> parameter fix the types information but if you the decompiler will fail to decompile it.</p>
<p>If you want to know how this tool is working, Check <a href="https://www.mandiant.com/resources/blog/golang-internals-symbol-recovery" target="_blank" rel="noopener noreffer ">this article</a>. Basically it search for <code>pclntab</code> structure by searching for a magic header and follow the pointer to symbols table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// pcHeader holds data used by the pclntab lookups.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">pcHeader</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">magic</span>          <span class="kt">uint32</span>
</span></span><span class="line"><span class="cl">													<span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">													go12magic  = 0xfffffffb
</span></span></span><span class="line"><span class="cl"><span class="cm">													go116magic = 0xfffffffa
</span></span></span><span class="line"><span class="cl"><span class="cm">													go118magic = 0xfffffff0
</span></span></span><span class="line"><span class="cl"><span class="cm">													go120magic = 0xfffffff1
</span></span></span><span class="line"><span class="cl"><span class="cm">													*/</span>
</span></span><span class="line"><span class="cl">	<span class="nx">pad1</span><span class="p">,</span> <span class="nx">pad2</span>     <span class="kt">uint8</span>   <span class="c1">// 0,0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">minLC</span>          <span class="kt">uint8</span>   <span class="c1">// min instruction size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">ptrSize</span>        <span class="kt">uint8</span>   <span class="c1">// size of a ptr in bytes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">nfunc</span>          <span class="kt">int</span>     <span class="c1">// number of functions in the module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">nfiles</span>         <span class="kt">uint</span>    <span class="c1">// number of entries in the file tab
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">textStart</span>      <span class="kt">uintptr</span> <span class="c1">// base for function entry PC offsets in this module, equal to moduledata.text
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">funcnameOffset</span> <span class="kt">uintptr</span> <span class="c1">// offset to the funcnametab variable from pcHeader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">cuOffset</span>       <span class="kt">uintptr</span> <span class="c1">// offset to the cutab variable from pcHeader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">filetabOffset</span>  <span class="kt">uintptr</span> <span class="c1">// offset to the filetab variable from pcHeader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">pctabOffset</span>    <span class="kt">uintptr</span> <span class="c1">// offset to the pctab variable from pcHeader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">pclnOffset</span>     <span class="kt">uintptr</span> <span class="c1">// offset to the pclntab variable from pcHeader
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is also used by the go parser itself in order to locate the function, For more info <a href="https://github.com/golang/go/blob/master/src/debug/gosym/pclntab.go#L211" target="_blank" rel="noopener noreffer ">here</a></p>
<p>Another set of scripts available we can use it doing the same thing is <a href="https://github.com/SentineLabs/AlphaGolang" target="_blank" rel="noopener noreffer ">Alphagolang</a></p>
<p>I will use Alphagolang here but both will provide similar result.</p>
<p>First I used <a href="https://github.com/SentineLabs/AlphaGolang/blob/main/1.recreate_pclntab.py" target="_blank" rel="noopener noreffer ">recreate_pclntab.py</a> script to recreate <code>pclntab</code> structure.</p>
<p>Second, I used <a href="https://github.com/SentineLabs/AlphaGolang/blob/main/2.function_discovery_and_renaming.py" target="_blank" rel="noopener noreffer ">function_discovery_and_renaming.py</a> script to rename the functions.</p>
<p>Third, I used <a href="https://github.com/SentineLabs/AlphaGolang/blob/main/3.categorize_go_folders.py" target="_blank" rel="noopener noreffer ">categorize_go_folders.py</a> to categorize the functions and pack them in folders, This will be very helpful to focus on user-code.</p>
<p>Fourth, I used <a href="https://github.com/SentineLabs/AlphaGolang/blob/main/4.string_cast.py" target="_blank" rel="noopener noreffer ">string_cast.py</a> to fix string references.</p>
<p>Fifth, I used <a href="https://github.com/SentineLabs/AlphaGolang/blob/main/5.extract_types.py" target="_blank" rel="noopener noreffer ">extract_types.py</a> to correct the types information by applying C like types to the used structures.</p>
<p>The result</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%203.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%203.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%203.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%203.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%203.png"
        title="Untitled" width="1920" height="627" /></p>
<p>Now, We have a better environment so we can start exploring the code efficiently.</p>
<h3 id="calling-conventions-in-go">Calling Conventions in GO</h3>
<p>In function calls, GO has a different calling convention.</p>
<p>All the argument are passed using the stack from the left to right. The following assembly code is in Go assembler format</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">testConv</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span><span class="k">return</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">testConv</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MOVQ</span> <span class="mh">0x8</span><span class="p">(</span><span class="nx">SP</span><span class="p">),</span> <span class="nx">AX</span>  <span class="p">;</span> <span class="nx">get</span> <span class="nx">arg</span> <span class="nx">x</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MOVQ</span> <span class="mh">0x10</span><span class="p">(</span><span class="nx">SP</span><span class="p">),</span> <span class="nx">CX</span> <span class="p">;</span> <span class="nx">get</span> <span class="nx">arg</span> <span class="nx">y</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ADDQ</span> <span class="nx">CX</span><span class="p">,</span> <span class="nx">AX</span>       <span class="p">;</span> <span class="o">%</span><span class="nx">ax</span> <span class="o">&lt;-</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MOVQ</span> <span class="nx">AX</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">(</span><span class="nx">SP</span><span class="p">)</span> <span class="p">;</span> <span class="k">return</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="o">-</span><span class="nx">z</span>
</span></span><span class="line"><span class="cl">	<span class="nx">RET</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>the compiler have to make sure that there is enough space on the stack to accommodate all the arguments and return values.</p>
<h3 id="strings-in-go">Strings in GO</h3>
<p>Go stores strings in a Unicode -UTF-8- format without null terminating characters in a section contain all the strings but.</p>
<p>Strings in go stored in structure of value and length pair called <code>StringHeader</code>. So, in all the function where a string argument is passed, you will see an extra argument contain the length of the string.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">StringHeader</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Data</span> <span class="kt">uintptr</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Len</span>  <span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>First we start with <code>main_init</code> function (<code>sub_595590</code>). In GO, <code>init()</code> is a predefined function that takes no argument, Return no values. And Runs before any code in the package.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%204.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%204.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%204.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%204.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%204.png"
        title="Untitled" width="1000" height="863" /></p>
<p>The block number 1 shows that it loads some DLLs and functions.</p>
<table>
<thead>
<tr>
<th>DLL</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>user32.dll</td>
<td>GetDesktopWindow</td>
</tr>
<tr>
<td>user32.dll</td>
<td>EnumDisplayMonitors</td>
</tr>
<tr>
<td>user32.dll</td>
<td>GetMonitorInfoW</td>
</tr>
<tr>
<td>user32.dll</td>
<td>EnumDisplaySettingsW</td>
</tr>
<tr>
<td>kernel32.dll</td>
<td>LocalFree</td>
</tr>
<tr>
<td>Crypt32.dll</td>
<td>CryptUnprotectData</td>
</tr>
</tbody>
</table>
<p>In Block number 2, It Reads the the environment Variable <code>USERPROFILE</code> and concatenate <code>\\APPDATA\\LOCAL\</code> and <code>\\APPDATA\\ROAMING\</code> and save the new string to the memory.</p>
<p>In block 3, It did the same thing to get the Paths <code>C:\\Users\\{user}\\APPDATA\\ROAMING,&lt;Local&gt;\\</code> but it replaces the string <code>C:\\Users</code> with <code>C:\\windows.old\Users</code> with Replace function from strings package</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Replace</span><span class="p">(</span><span class="nx">original</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">old</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">new</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">n</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl"><span class="c1">//where n is the number of times replacing occures. -1 for replace all
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>this location is created when the user update from one version to another and it contains all the old information from the previous installation.</p>
<p>moving to <code>main_main</code> (<code>sub_595470</code>). It creates a new procedure by making a call to <code>newproc</code> function from <code>runtime</code> package.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%205.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%205.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%205.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%205.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%205.png"
        title="Untitled" width="383" height="107" /></p>
<h3 id="connect-to-server">Connect To server</h3>
<p>following the code to <code>main_ConnectToServer</code> (<code>sub_58ABE0</code>). This function has some interesting functionality we will explore next.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%206.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%206.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%206.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%206.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%206.png"
        title="Untitled" width="1061" height="882" /></p>
<p>In block 1, the malware sleeps for 1000000000 nanoseconds -I tried a simple program with the same call to sleep and it was equivalent to time.Nanosecond -</p>
<p>Then it establishes a TCP connection to <code>82.115.223.249:8081</code> IP address using function <code>Dial</code> from <code>net</code> package. Then it Reads the Received packet. the <code>Dial</code> function in GO returns 2 values, <code>Conn</code> interface and Error, which IDA cannot recognize so, I will follow my intuition. If the connection returned error, it will try to reconnect again.</p>
<p>In Block 2, The connection was established but it first checks the response from the remote IP. If it was blocked due to the geo location, as the IP is Russian, it will try to reconnect.</p>
<p>If the response was <code>WORK</code> string, the connection is established successfully and the malware can continue with its functionality as shown in block 3 and 4</p>
<h3 id="collect-victim-information">Collect victim information</h3>
<p>Moving to <code>main_GetInfoUser()</code> (<code>sub_58B880</code>). The first Lines in this subroutine takes us to another function, <code>main_MachineID</code> (<code>sub_5897A0</code>)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%207.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%207.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%207.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%207.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%207.png"
        title="Untitled" width="588" height="409" /></p>
<p>The malware Runs the command <code>cmd.exe /c wmic csproduct get uuid</code> to get UUID of the device. Returning to <code>main_GetInfoUser</code> .</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%208.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%208.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%208.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%208.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%208.png"
        title="Untitled" width="909" height="465" /></p>
<p>It retrieves the screen width and height using win32 API <code>GetSystemMetrics</code> , GO allow using third-party packages directly from GitHub and the the cause of the function naming. The screen resolution is represented in the format <code>&lt;width&gt;x&lt;height&gt;</code> .</p>
<p>The next call is to <code>main_GetOS</code> (<code>sub_58A530</code>).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%209.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%209.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%209.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%209.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%209.png"
        title="Untitled" width="645" height="454" /></p>
<p>This function retrieves the OS version using wmic command <code>wmic os get Caption</code> . and filter the output based on the form it is printed to format is in a space separated string.</p>
<p>Returning back to <code>main_GetInfoUser</code> a call to <code>main_getGPU</code> (<code>sub_58A200</code>) is made.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2010.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2010.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2010.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2010.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2010.png"
        title="Untitled" width="513" height="338" /></p>
<p>The GPU information retrieved by executing the command <code>cmd /C wmic path win32_VideoController get name</code></p>
<p>Using the same method in <code>main_getCPU</code> (<code>sub_589F10</code>). It gets CPU information with command <code>cmd /c wmic cpu get name</code></p>
<p>in <code>main_sysTotalMemory</code> (<code>sub_58B550</code>)It gets the memory status by executing <code>GlobalMemoryStatusEx</code> function.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2011.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2011.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2011.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2011.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2011.png"
        title="Untitled" width="530" height="291" /></p>
<p><code>main_CMD_SHELL</code> is called to execute <code>cmd /c systeminfo</code> that gets all the specs of the device.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2012.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2012.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2012.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2012.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2012.png"
        title="Untitled" width="576" height="439" /></p>
<p>That was the last thing the function <code>main_GetInfoUser</code> do.</p>
<p>Back in <code>main_main</code> , the function <code>main_grab</code> (<code>sub_593E80</code>) is called. This function responsible for doing the main goal of the malware, Stealing.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2013.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2013.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2013.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2013.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2013.png"
        title="Untitled" width="597" height="880" /></p>
<ul>
<li><code>panic</code> function is used to check for unexpected errors. common use of panic is to abort if a function returns an error value that we don’t want to handle.</li>
</ul>
<h3 id="file-grabber">File grabber</h3>
<p>Going to the first function <code>main_file_grabber</code> (<code>sub_594110</code>)</p>
<p>this function search for a specific file taken from the C2 server and it is base64 encoded and in JSON format.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2014.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2014.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2014.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2014.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2014.png"
        title="Untitled" width="520" height="119" /></p>
<p>Then, It search for the file in some predefined directories and location.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2015.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2015.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2015.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2015.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2015.png"
        title="Untitled" width="991" height="699" /></p>
<p>the function <code>io_ioutil_ReadDir</code> reads the content of the directory and stores the output in a <code>fs.fileinfo</code> structure , sorted by the filename</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">FileInfo</span> <span class="kd">interface</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>       <span class="c1">// base name of the file
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nf">Size</span><span class="p">()</span> <span class="kt">int64</span>        <span class="c1">// length in bytes for regular files; system-dependent for others
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nf">Mode</span><span class="p">()</span> <span class="nx">FileMode</span>     <span class="c1">// file mode bits
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nf">ModTime</span><span class="p">()</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span> <span class="c1">// modification time
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nf">IsDir</span><span class="p">()</span> <span class="kt">bool</span>        <span class="c1">// abbreviation for Mode().IsDir()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nf">Sys</span><span class="p">()</span> <span class="nx">any</span>           <span class="c1">// underlying data source (can return nil)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then it walks through the returned structure and reads the file of interest</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2016.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2016.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2016.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2016.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2016.png"
        title="Untitled" width="795" height="419" /></p>
<p>then it encode the file content in Base64 and adds the tags used in the JSON formatted packet content to be sent to the remote system</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2017.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2017.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2017.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2017.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2017.png"
        title="Untitled" width="671" height="393" /></p>
<h3 id="browser-data">Browser data</h3>
<p>We will visit <code>SendToServer</code> latter. Now, lets go back to the caller function and explore the next function, <code>main_Grab_func3</code> (<code>sub_58F0B0</code>).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2018.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2018.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2018.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2018.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2018.png"
        title="Untitled" width="965" height="244" /></p>
<p>This function goes through the %APPDATA%Roaming directory and calls another function. the function <code>path_filepath_Walk</code> walks the directory from the Root passed in the second parameter calling a function <code>fn.WinDirFunc</code> at each file and directory in it including the Root.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Walk</span><span class="p">(</span><span class="nx">root</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">fn</span> <span class="nx">WalkFunc</span><span class="p">)</span> <span class="kt">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">WalkFunc</span> <span class="kd">func</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">info</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So, Next one to visit is <code>WalkFunc</code> used <code>main_Grab_func3_2</code> (<code>sub_58DED0</code>).</p>
<p>This function steals the Browser information stored</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2019.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2019.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2019.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2019.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2019.png"
        title="Untitled" width="772" height="217" /></p>
<p>For Chromium based browsers it gets the Local State file and calls <code>main_getMasterKey</code> that as the name suggest, Gets the master key and decode it .then, decrypts it by calling <code>CryptUnprotectData</code> which is called from <code>main_xDecrypt</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2020.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2020.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2020.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2020.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2020.png"
        title="Untitled" width="723" height="200" /></p>
<p>It handles the case of using Opera and Firefox browsers</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2021.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2021.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2021.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2021.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2021.png"
        title="Untitled" width="764" height="181" /></p>
<p>Back to the caller function, The malware steals the password and cookies from the browser data and adds the tags of the JSON file to be sent to the C2 server.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2022.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2022.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2022.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2022.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2022.png"
        title="Untitled" width="223" height="111" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2023.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2023.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2023.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2023.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2023.png"
        title="Untitled" width="245" height="109" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2024.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2024.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2024.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2024.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2024.png"
        title="Untitled" width="265" height="108" /></p>
<h3 id="crypto">Crypto</h3>
<p>Then, It goes through the %USERPROFILE% searching for any Crypto wallets information</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2025.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2025.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2025.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2025.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2025.png"
        title="Untitled" width="672" height="144" /></p>
<p>It Looks for PC applications and Web based wallets and add its associated type and name to the JSON data to be sent</p>
<h3 id="screenshot-capture">Screenshot Capture</h3>
<p>function <code>main_Grab_func_7</code> (<code>sub_591D50</code>) is used to take a screenshot from the victim system</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2026.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2026.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2026.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2026.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2026.png"
        title="Untitled" width="433" height="99" /></p>
<p>The PNG file is then base64 encoded and add the value to the tag <code>screenshot</code> to be sent.</p>
<h3 id="telegram-data">Telegram Data</h3>
<p>The next targeted information is Telegram, It did the same procedure discussed before with telegram data folder at <code>main_Grab_func_6</code> (<code>sub_591980</code>)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2027.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2027.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2027.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2027.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2027.png"
        title="Untitled" width="754" height="160" /></p>
<p><code>WalkFunc</code> → <code>main_Grab_func_6_2</code> (<code>sub_591120</code>)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2028.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2028.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2028.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2028.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2028.png"
        title="Untitled" width="614" height="261" /></p>
<h3 id="steam-data">Steam data</h3>
<p>function <code>main_Grab_func9</code> (<code>sub_593B30</code>) steals steam data in the same way</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2029.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2029.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2029.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2029.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2029.png"
        title="Untitled" width="1570" height="621" /></p>
<h3 id="send-to-server">send To server</h3>
<p><code>main_SendToServer_NEW</code> (<code>sub_594DD0</code>) is used to send the collected data to the server.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2030.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2030.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2030.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2030.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2030.png"
        title="Untitled" width="1374" height="478" /></p>
<p>The collected information stored in JSON format. the Data then compressed using <code>gzip</code> compression algorithm and encoded with Base64 encoding to be sent to the server using the previously established TCP connection.</p>
<h2 id="network-analysis">Network Analysis</h2>
<p>we can look at the network communication using <a href="https://app.any.run/tasks/e67ff1df-1b55-451e-bdad-23849a10b650/" target="_blank" rel="noopener noreffer ">PCAP file</a> provided by Any Run sandbox.</p>
<p>By opening the file in Wireshark and filter using the IP <code>82.115.223.249</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2031.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2031.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2031.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2031.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2031.png"
        title="Untitled" width="1134" height="670" /></p>
<p>Following the TCP stream</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2032.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2032.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2032.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2032.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2032.png"
        title="Untitled" width="1249" height="789" /></p>
<p>The first packet received is WORK indicates that the connection is successful and the malware then begin to collect the required data and compress it and send it to the server. At the last packet received from the the C2 server is <code>Thanks</code>.</p>
<p>we can use Cyberchef to decode and decompress the data.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2033.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2033.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2033.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2033.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2033.png"
        title="Untitled" width="1703" height="831" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2034.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2034.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2034.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2034.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2034.png"
        title="Untitled" width="1849" height="685" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2035.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2035.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2035.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2035.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2035.png"
        title="Untitled" width="567" height="694" /></p>
<p>the Error list include the files that the malware cannot read or access. On of the packets has a very large size, as the screenshot field has a very large Base64 encoded data</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2036.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2036.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2036.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2036.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2036.png"
        title="Untitled" width="1888" height="678" /></p>
<p>the screenshot:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2037.png"
        data-srcset="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2037.png, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2037.png 1.5x, /aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2037.png 2x"
        data-sizes="auto"
        alt="/aurora-stealer/Aurora%20Stealer%203ac5d7639dee4d95b3cfd546053de596/Untitled%2037.png"
        title="Untitled" width="1280" height="720" /></p>
<p>Sample JSON file can be found here <a href="https://pastebin.com/YpTwAC94" target="_blank" rel="noopener noreffer ">https://pastebin.com/YpTwAC94</a></p>
<h2 id="conclusion">Conclusion</h2>
<p>Aurora stealer is a new commercial infostealer. Most of it&rsquo;s capabilities are typical things that can be found in most of the stealers.
it can grab Browser saved password/cookies and Cryptocurrency wallets information from Desktop applications and Web based wallets.
Also, it can grab a files from the victim machine and take a screenshot. The communication with C2 server is done over TCP protocol.
Most of these things can be found in most of the stealer But being written in GO makes it special, even it has a plaintext strings, The reversing process is quite annoying as most of the tools cannot handle GO binaries in a right way.</p>
<h2 id="iocs">IOCs:</h2>
<ul>
<li>29339458f4a33ee922f25d36b83f19797a15a279634e9c44ebd3816866a541cb</li>
<li>82.115.223[.]249:8081</li>
</ul>
<h2 id="yara-rule">Yara Rule</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rule</span> <span class="n">aurora_stealer</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">malware</span> <span class="o">=</span> <span class="s2">&#34;Aurora stealer&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">hash</span> <span class="o">=</span> <span class="s2">&#34;29339458f4a33ee922f25d36b83f19797a15a279634e9c44ebd3816866a541cb&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">reference</span> <span class="o">=</span> <span class="s2">&#34;https://d01a.github.io/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Author</span> <span class="o">=</span> <span class="s2">&#34;d01a&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;detect Aurora stealer&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">strings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">is_go</span> <span class="o">=</span> <span class="s2">&#34;Go build&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a1</span> <span class="o">=</span> <span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Windows.old</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a2</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">AppData</span><span class="se">\\</span><span class="s2">Roaming</span><span class="se">\\</span><span class="s2">&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a3</span> <span class="o">=</span> <span class="s2">&#34;wmic csproduct get uuid&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a4</span> <span class="o">=</span> <span class="s2">&#34;wmic cpu get name&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a5</span> <span class="o">=</span> <span class="s2">&#34;systeminfo&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">a6</span> <span class="o">=</span> <span class="s2">&#34;coNNNECTIONGWQFGQW&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun1</span> <span class="o">=</span> <span class="s2">&#34;main.Grab&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun2</span> <span class="o">=</span> <span class="s2">&#34;main.getMasterKey&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun3</span> <span class="o">=</span> <span class="s2">&#34;main.SendToServer_NEW&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun4</span> <span class="o">=</span> <span class="s2">&#34;main.ConnectToServer&#34;</span>  <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun5</span> <span class="o">=</span> <span class="s2">&#34;main.xDecrypt&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">    <span class="err">$</span><span class="n">fun6</span> <span class="o">=</span> <span class="s2">&#34;main.GetDisplayBounds&#34;</span> <span class="n">ascii</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">condition</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5a4d</span> <span class="ow">and</span> <span class="p">(</span> <span class="err">$</span><span class="n">is_go</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">4</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">a</span><span class="o">*</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">4</span> <span class="n">of</span> <span class="p">(</span><span class="err">$</span><span class="n">fun</span><span class="o">*</span><span class="p">))</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="references">References</h2>
<ul>
<li><a href="https://gist.github.com/alexander-hanel/59af86b0154df44a2c9cebfba4996073" target="_blank" rel="noopener noreffer ">https://gist.github.com/alexander-hanel/59af86b0154df44a2c9cebfba4996073</a></li>
<li><a href="https://go.dev/src/syscall/syscall_windows.go" target="_blank" rel="noopener noreffer ">The Go Programming Language</a></li>
<li><a href="https://pkg.go.dev/runtime" target="_blank" rel="noopener noreffer ">https://pkg.go.dev/</a></li>
<li><a href="https://app.any.run/tasks/e67ff1df-1b55-451e-bdad-23849a10b650/" target="_blank" rel="noopener noreffer ">PCAP file</a></li>
<li><a href="https://dr-knz.net/go-calling-convention-x86-64.html" target="_blank" rel="noopener noreffer ">https://dr-knz.net/go-calling-convention-x86-64.html</a></li>
<li><a href="https://dr-knz.net/go-calling-convention-x86-64-2020.html" target="_blank" rel="noopener noreffer ">https://dr-knz.net/go-calling-convention-x86-64-2020.html</a></li>
<li><a href="https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar/" target="_blank" rel="noopener noreffer ">Aurora: a rising stealer flying under the radar - SEKOIA.IO Blog</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-04-14&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/a1018f2f2b9638ebd8f4f2333028ea05493de18b" target="_blank" title="commit by mohamedadel46(muhammed195826@feng.bu.edu.eg) a1018f2f2b9638ebd8f4f2333028ea05493de18b: update">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>a1018f2</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/aurora-stealer/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://d01a.github.io/aurora-stealer/" data-title="Aurora Stealer" data-via="0xd01a" data-hashtags="Malware Analysis,Reverse Engineering"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://d01a.github.io/aurora-stealer/" data-hashtag="Malware Analysis"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://d01a.github.io/aurora-stealer/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://d01a.github.io/aurora-stealer/" data-title="Aurora Stealer"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://d01a.github.io/aurora-stealer/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://d01a.github.io/aurora-stealer/" data-title="Aurora Stealer"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://d01a.github.io/aurora-stealer/" data-title="Aurora Stealer"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Trello" data-sharer="trello" data-url="https://d01a.github.io/aurora-stealer/" data-title="Aurora Stealer" data-description="Aurora Stealer"><i class="fab fa-trello fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/malware-analysis/">Malware Analysis</a>,&nbsp;<a href="/tags/reverse-engineering/">Reverse Engineering</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/originlogger/" class="prev" rel="prev" title="OriginLogger Loader"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>OriginLogger Loader</a>
            <a href="/aurora-stealer-builder/" class="next" rel="next" title="Aurora Stealer Builder">Aurora Stealer Builder<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.102.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Mohamed Adel</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
